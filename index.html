<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FutStats - Card de Jogador</title>
    <style>
        /* --- ESTILO (CSS) --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 { color: #4CAF50; }

        .container {
            width: 100%;
            max-width: 400px;
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        input, button {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            border: 1px solid #333;
            box-sizing: border-box; /* Garante que o padding não aumente a largura */
        }

        input {
            background-color: #2c2c2c;
            color: white;
        }

        button {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            border: none;
        }

        button:hover { background-color: #45a049; }

        /* Estilo do Card do Jogador */
        #player-card {
            display: none; /* Escondido até carregar */
            margin-top: 20px;
            text-align: center;
            border: 2px solid #4CAF50;
            padding: 20px;
            border-radius: 15px;
            background: linear-gradient(145deg, #2a2a2a, #1e1e1e);
        }

        .player-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 3px solid #4CAF50;
            object-fit: cover;
        }

        .team-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
            color: #bbb;
        }

        /* Grid de estatísticas */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .stat-box {
            background-color: #333;
            padding: 10px;
            border-radius: 8px;
        }

        .stat-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #4CAF50;
        }

        .stat-label { font-size: 0.8em; color: #ddd; }

        .loading { display: none; color: #4CAF50; margin-top: 10px; }
        .error { color: #ff5252; margin-top: 10px; display: none; }
    </style>
</head>
<body>

    <h1>⚽ FutStats Search</h1>

    <div class="container">
        <input type="password" id="apiKey" placeholder="Cole sua API Key aqui (API-Football)">
        <input type="text" id="playerName" placeholder="Nome do Jogador (ex: Messi)">
        <button onclick="buscarJogador()">Gerar Card</button>

        <div id="loading" class="loading">Buscando dados...</div>
        <div id="error" class="error"></div>

        <div id="player-card">
            <img id="p-photo" src="" class="player-photo">
            <h2 id="p-name">Nome</h2>
            <p id="p-info">Idade | País</p>
            <hr style="border-color: #444;">

            <div class="team-info">
                <img id="t-logo" src="" width="30">
                <span id="t-name">Time</span>
            </div>
            <p id="l-name" style="font-size: 0.9em; color: #888;">Liga</p>

            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-value" id="s-games">0</div>
                    <div class="stat-label">Jogos</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="s-goals">0</div>
                    <div class="stat-label">Gols</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="s-assists">0</div>
                    <div class="stat-label">Assistências</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="s-rating">0.0</div>
                    <div class="stat-label">Nota Média</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- LÓGICA (JAVASCRIPT) ---
        async function buscarJogador() {
            const apiKey = document.getElementById('apiKey').value;
            const name = document.getElementById('playerName').value;
            const loading = document.getElementById('loading');
            const errorDiv = document.getElementById('error');
            const card = document.getElementById('player-card');

            // Limpa estados anteriores
            errorDiv.style.display = 'none';
            card.style.display = 'none';

            if (!apiKey || !name) {
                mostrarErro("Preencha a API Key e o nome do jogador.");
                return;
            }

            loading.style.display = 'block';

            const season = 2024; // Temporada fixa (pode mudar se quiser)

            const options = {
                method: 'GET',
                headers: {
                    'x-rapidapi-key': apiKey,
                    'x-rapidapi-host': 'v3.football.api-sports.io'
                }
            };

            try {
                const response = await fetch(`https://v3.football.api-sports.io/players?search=${name}&season=${season}`, options);
                const data = await response.json();

                loading.style.display = 'none';

                if (data.errors && Object.keys(data.errors).length > 0) {
                    mostrarErro("Erro da API. Verifique sua chave.");
                    console.log(data.errors);
                    return;
                }

                if (data.results === 0) {
                    mostrarErro("Jogador não encontrado nesta temporada.");
                    return;
                }

                renderizarCard(data.response[0]);

            } catch (err) {
                loading.style.display = 'none';
                mostrarErro("Erro de conexão.");
                console.error(err);
            }
        }

        function renderizarCard(data) {
            const p = data.player;
            const s = data.statistics[0]; // Pega a primeira liga disponível

            document.getElementById('p-photo').src = p.photo;
            document.getElementById('p-name').textContent = p.name;
            document.getElementById('p-info').textContent = `${p.age} anos | ${p.nationality}`;

            document.getElementById('t-logo').src = s.team.logo;
            document.getElementById('t-name').textContent = s.team.name;
            document.getElementById('l-name').textContent = s.league.name;

            // Função segura para evitar null/vazio
            const check = (val) => val === null ? 0 : val;

            document.getElementById('s-games').textContent = check(s.games.appearences);
            document.getElementById('s-goals').textContent = check(s.goals.total);
            document.getElementById('s-assists').textContent = check(s.goals.assists);
            document.getElementById('s-rating').textContent = s.games.rating ? parseFloat(s.games.rating).toFixed(2) : '-';

            document.getElementById('player-card').style.display = 'block';
        }

        function mostrarErro(msg) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = msg;
            errorDiv.style.display = 'block';
        }
    </script>
</body>
</html>
